{{ define "main" }}
  <section class="section">
    <div class="container">
      {{ .Content }}
    </div>
  </section>

  <section class="section">
    <div class="container">
      <h2 class="h4 mb-4">Latest articles</h2>
      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">

        {{/* Only from content/blog */}}
        {{ $candidates := where .Site.RegularPages "Section" "blog" }}
        {{ range first 6 (sort $candidates "Date" "desc") }}

        <div class="col">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h5 card-title"><a href="{{ .RelPermalink }}">{{ .Title }}</a></h3>
              {{ with .Date }}<div class="text-muted small mb-2">{{ .Format "2006-01-02" }}</div>{{ end }}
              <p class="card-text">{{ .Summary }}</p>
              <div class="mt-3">
                {{ $tags := .Params.tags | default (slice) }}
                {{ $limit := cond (gt (len $tags) 3) 3 (len $tags) }}
                {{ range first $limit $tags }}
                  <a class="badge bg-light text-dark border me-1" href="/tags/{{ . | urlize }}/">#{{ . }}</a>
                {{ end }}
              </div>
            </div>
          </div>
        </div>

        {{ end }}

        {{/* Fallback if no posts */}}
        {{ if not (gt (len $candidates) 0) }}
          <div>No blog posts found under content/blog</div>
        {{ end }}

      </div>
    </div>
  </section>
{{ end }}
